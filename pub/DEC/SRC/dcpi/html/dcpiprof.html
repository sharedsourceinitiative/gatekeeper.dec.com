<!-- This file generated automatically by mtex2html(1) -->
<HTML>
<HEAD>
<TITLE>dcpiprof</TITLE>
</HEAD>

<BODY BGCOLOR="#ffffff" VLINK="#006633">
<H2>dcpiprof(1)</H2>

<H3>NAME</H3>
<BLOCKQUOTE>
dcpiprof - Analyze profile data collected by <TT>dcpid</TT>
</BLOCKQUOTE>

<H3>SYNOPSIS</H3>
<BLOCKQUOTE>
<B>dcpiprof</B>
[-i]
[-s <I>event-type</I>]
[-keep <I>percentage</I>]
[-p <I>image-file-name</I>]
[-m <I>map-file-name</I>]
[-no_header]
[-full_output]
[<I>image-names...</I>]
</BLOCKQUOTE>

<H3>FLAGS</H3>
<BLOCKQUOTE>
<DL>
<DT>-i<DD>
   Lists samples collected per image (instead of the default
   samples per procedure).
<DT>-s event<DD>
   The named event type is used to sort the profile output.
   Otherwise, the output is sorted by cycles so that the
   procedure or image that accounts for the most cycles is
   listed first.
<DT>-keep p<DD>
   Lists just enough top routines to account for the top <I>p</I>
   percent of the samples of the event type used to sort the
   profile output.  The value <I>p</I> may be a floating point
   number in the range <TT>[0..100]</TT>.
<DT>-p image-file-name<DD>
   Use the specified image file as a candidate when associating
   profiles with named image files.  This option can be repeated,
   allowing several image names to be specified on the command line.
<DT>-m map-file-name<DD>
   Use specified map file generated by dcpiscan(1) for associating
   profiles with named images.  This option can be repeated, allowing
   several map files to be specified; information from all of the
   supplied map files is merged.  The <TT>-m</TT> option works like the
   <TT>-p</TT> option, except that instead of specifying one image at a
   time, a whole set of images can be entered into a map file via
   dcpiscan(1) and the entire set can be specified with one command line option.<P>

A default map for common Digital Unix 3.2 and 4.0
   binaries is compiled into dcpid; specifying additional maps will
   allow dcpiprof to find site-specific binaries.<P>

<DT>-no_header<DD>
   Do not print any header in the output.  This option may be useful
   for programs that parse the output of dcpiprof.
<DT>-full_output<DD>
   Prints extra information per line.  This information may be useful
   for programs that parse the output of dcpiprof.  The format of this
   extra information has not yet been documented because it is evolving.
</DL>
<P>

</BLOCKQUOTE>

<H3>PROFILE FILE FLAGS</H3>
<BLOCKQUOTE>
<P>

By default, this command automatically finds all of the relevant
profile files.  The following options can be used to guide the search
for the profile files.<P>

<DL>
<DT>-db &lt;directory name&gt;<DD>
Search for profile files in the specified profile database directory.
The directory name should be the same name as the one specified when
<TT>dcpid</TT> was started.  I.e., the named directory should contain a
set of epochs.  If this option is not specified, the directory name is
obtained from the <TT>DCPIDB</TT> environment variable.  If neither this
option, nor the <TT>DCPIDB</TT> environment variable are set, the name of
the directory used by the last invocation of <TT>dcpid</TT> on this
machine is used.  If none of these methods succeed in finding the
appropriate directory, and no explicit set of profile files is
provided via the <TT>-profiles</TT> option, then the command fails.<P>

<DT>-epoch latest<DD>
Search for profile files in the latest epoch.  This is the default.<P>

<DT>-epoch latest-k<DD>
Search for profile files in the "k+1"th oldest epoch.  For example,
search in the third last epoch if "-epoch latest-2" is specified.<P>

<DT>-epoch all<DD>
Search for profile files in all epochs.<P>

<DT>-epoch &lt;name&gt;<DD>
Search for profile files in the named epoch.  The epoch name should be
the name of a subdirectory corresponding to a single epoch within the
profile database directory.  Epoch subdirectory names usually take
the form <TT>YYMMDDHHMM</TT> (year-month-day-hours-minutes).  For example,
an epoch started on December 4, 1996 at 23:34 is named <TT>9612042334</TT>.
If an epoch is given a symbolic name by creating a symbol link to
the actual epoch directory, then the symbolic name can also be used
as an argument to the <TT>-epoch</TT> option.<P>

<DT>-events all<DD>
Search for profile files corresponding to all event types such as
cycles, icache misses, branch mispredictions, etc.  This is the default.<P>

<DT>-events type(+type)*<DD>
Search for profiles files for the specified event types.  For example,
search for cycles, icache misses, and data cache misses when the
option <TT>-events cycles+imiss+dmiss</TT> is specified.<P>

<DT>-events all(-type)*<DD>
Search for profile files for all event types except for the specified
types.  For example, search for all event types except for branch
mispredictions when the option <TT>-events all-branchmp</TT> is specified.<P>

<DT>-label &lt;label&gt;<DD>
Search for profile files with the specified label (see <TT>dcpilabel</TT>).
If no labels are specified on the command line, profile file labels
are ignored entirely.  If any labels are specified on the command line
(this option can be repeated several times), only profile files that
have one of the specified labels are used.<P>

<DT>-profiles &lt;file names...&gt; --<DD>
Use just the profile files named by the specified file names.  The
list of profile file names can be terminated either via <TT>--</TT>, or by
the end of the option list.  The command prints an error message and
fails if the <TT>-profiles</TT> option is used in conjunction with any of
the earlier automatic profile finding options.  (Use either the
automatic profile lookup mechanism, or explicitly name the profile
file with the <TT>-profile</TT> option, but not both.)
</DL>
<P>

</BLOCKQUOTE>

<H3>DESCRIPTION</H3>
<BLOCKQUOTE>
<P>

Dcpiprof summarizes a set of profile files by printing a histogram of
the number of samples per procedure (or the number of samples per
image with the -i option.)  The output is sorted by decreasing number
of samples found within that procedure (or image).  Each entry in the
listing is annotated with the number of samples, the percentage of
samples that belong to this entry, and a cumulative percentage value.<P>

If some image names are specified on the command line, then only the
profile files corresponding to the specified images are used to
generate the output.  Otherwise, if the -i option is specified and no
image names are listed on the command line, then dcpiprof reads all
profile files found in the profile database.  If the -i option is not
specified, and no images are listed on the command line, then dcpiprof
prints an error message and exits.<P>

Dcpiprof sometimes reports that it could not open some image files.
In such cases, you can help dcpiprof locate the appropriate image
files either by using the <TT>-p</TT> option to specify the name of an
image file of interest, or by using the <TT>-m</TT> option to supply an
image map generated by dcpiscan(1).
</BLOCKQUOTE>

<H3>EXAMPLE USAGE</H3>
<BLOCKQUOTE>
<P>

<DL>
<DT><TT>dcpiprof -i</TT><DD>
Use dcpiprof to analyze the breakdown of cpu time across all
images that contribute to the contents of the profile database.<P>

<DT><TT>dcpiprof  &lt;image names...&gt;</TT><DD>
Use dcpiprof to analyze the breakdown of cpu time across all
procedures for the specified images.<P>

<DT><TT>dcpiprof -keep 99.99 ...</TT><DD>
Stop the output after accounting for 99.99% of the samples.
</DL>
<P>

</BLOCKQUOTE>

<H3>INTERPRETING THE OUTPUT</H3>
<BLOCKQUOTE>
<P>

Dcpiprof prints a header, followed by a number of lines of output.  If
per-image profiles are being produced, then there is a line per image,
and the last column in the line is the name of the image.  Otherwise
there is a line per procedure and the last two columns contain the
name of the procedure and the image to which the procedure belongs.<P>

For example, consider the following output:
<PRE>
  Total samples for event type cycles   = 21761024463
  Total samples for event type imiss    = 1943063555
  
  The counts given below are the number of samples for each
  listed event type.
  ==========================================================
      cycles       %    cum%      imiss       % procedure       image
  9479311336  43.56%  43.56%   94570129   4.87% idle_thread     /vmunix
  3093399786  14.22%  57.78%  359058745  18.48% _XentInt        /vmunix
  2982861812  13.71%  71.48%   32386524   1.67% gh_zero_memory  /vmunix
  ...
</PRE>

This provides information on two different types of events: <TT>cycles</TT>
events and <TT>imiss</TT> events (i.e., instruction cache misses).<P>

The first three columns in each line contain information about the
number of event samples that correspond to the event used to sort the
dcpiprof output (<TT>cycles</TT> by default.)  The first one of these
columns lists the number of event samples that fell within this
image/procedure (i.e. 9479311336 within <TT>idle_thread</TT>).  The second
column lists the percentage these event samples form of the total
number of samples of this event type listed in dcpiprof's output
(i.e. 14.22% of all cycle samples in dcpiprof's output fell within
<TT>_XentInt</TT>).  The third column gives the cumulative percentage of
all event samples on this line and above (i.e. the top three
procedures in the example account for 71.48% of the cycle samples.)<P>

The remaining columns report the number of samples of other secondary
event types.  There are two such columns per secondary event type.
The first column lists of the number of samples of that type
(i.e. 94570129 imiss samples for <TT>idle_thread</TT>).
The second column lists the percentage this number forms of the total
number of samples of that type listed in dcpiprof's output
(i.e. 18.48% of all imiss samples in dcpiprof's output fell within
<TT>_XentInt</TT>).
</BLOCKQUOTE>

<H3>OBSOLETE SYNTAX</H3>
<BLOCKQUOTE>
<P>

If the environment variable <TT>DCPIPROF_OLDSYNTAX</TT> is set, dcpiprof
emulates versions of dcpiprof older than 1.45.  The old versions
support the syntax:
<PRE>
    dcpiprof [options] [&lt;profile file names...&gt;]
</PRE>

I.e., the profile file names are specified explicitly on the command
line, instead of via the profile file flags described earlier in this
document.  If no profile file names are listed on the command line,
the names are read from standard input.<P>

The old command line interface is supported for the use of old shell
scripts.  Users should just use the <TT>-profiles</TT> option if they need
to specify profile file names explicitly.
</BLOCKQUOTE>

<H3>SEE ALSO</H3>
<BLOCKQUOTE>
<P>

<A HREF="dcpi.html">dcpi(1)</A>,
<A HREF="dcpiflow.html">dcpiflow(1)</A>,
<A HREF="dcpilist.html">dcpilist(1)</A>,
<A HREF="dcpidis.html">dcpidis(1)</A>,
<A HREF="dcpiscan.html">dcpiscan(1)</A>,
<A HREF="dcpiepoch.html">dcpiepoch(1)</A>,
<A HREF="dcpiflush.html">dcpiflush(1)</A>,
<A HREF="dcpicalc.html">dcpicalc(1)</A>,
<A HREF="dcpilabel.html">dcpilabel(1)</A>,
<A HREF="dcpi2ps.html">dcpi2ps(1)</A>,
<A HREF="dcpicat.html">dcpicat(1)</A>,
<A HREF="dcpiquit.html">dcpiquit(1)</A>,
<A HREF="dcpidiff.html">dcpidiff(1)</A>,
<A HREF="dcpitopstalls.html">dcpitopstalls(1)</A>,
<A HREF="dcpiwhatcg.html">dcpiwhatcg(1)</A>,
<A HREF="dcpictl.html">dcpictl(1)</A>,
<A HREF="dcpisource.html">dcpisource(1)</A>,
<A HREF="dcpicc.html">dcpicc(1)</A>,
<A HREF="dcpiversion.html">dcpiversion(1)</A>,
<A HREF="dcpiuninstall.html">dcpiuninstall(1)</A>,
<A HREF="dcpi2pix.html">dcpi2pix(1)</A>,
<A HREF="dcpikdiff.html">dcpikdiff(1)</A>,
<A HREF="dcpix.html">dcpix(1)</A>,
<A HREF="dcpisumxct.html">dcpisumxct(1)</A>,
<A HREF="dcpistats.html">dcpistats(1)</A>,
<A HREF="dcpid.html">dcpid(1)</A>,
<A HREF="dcpiformat.html">dcpiformat(4)</A>,
<A HREF="dcpiloader.html">dcpiloader(5)</A><P>

For more information, see the 
<A HREF="../home.html">DIGITAL Continuous
Profiling Infrastructure project home page
(http://www.research.digital.com/SRC/dcpi/ from outside DIGITAL)</A>.
</BLOCKQUOTE>

<H3>COPYRIGHT</H3>
<BLOCKQUOTE>
<P>

<a href="http://www.digital.com/info/tm.html">
Copyright 1996-97, Digital Equipment Corporation.
</a>
</BLOCKQUOTE>

<H3>AUTHOR</H3>
<BLOCKQUOTE>
Sanjay Ghemawat,
Monika Henzinger
</BLOCKQUOTE>

This page was generated automatically by
<A HREF="http://www.research.digital.com/SRC/mtex/">mtex software</A>.
</BODY>
</HTML>
